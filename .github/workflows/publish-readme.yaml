name: Publish README on Confluence
on:
  push:
    branches:
      - "master"

jobs:
  publish-readme:
    name: Publish README on Confluence
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v5
      - uses: hazelcast/confluence-markdown-sync@master
        with:
          from: './README.md'
          to: '4774690840'
          content_prefix: "<i>Page autogenerated by <a href=\"https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}\">\"${{ github.workflow }}\" workflow</a></i>"
          cloud: hazelcast
          user: ${{ secrets.CONFLUENCE_USERNAME }}
          token: ${{ secrets.CONFLUENCE_API_TOKEN }}
      - uses: 8398a7/action-slack@v3
        if: failure()
        with:
          fields: all
          status: ${{ job.status }}
          channel: "#dependabot-notifications"
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_FOR_AUTOMERGING }}